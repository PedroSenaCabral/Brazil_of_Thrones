/* *** Perguntas *** */


/*************************************** PERGUNTAS ***************************************/
const perguntasNorte= [{
    conflito: "<h2>Revolução do ??? </h2> <br /><br /> <strong> Clique no estado em que ocorreu esse conflito. </strong>",
    infoEstado: "<br /> <p> A Floresta Amazônica recobre todo o território estadual. Muito rica em seringueiras da espécie mais valiosa e Castanheiras, a floresta garante ao estado o lugar de maior produtor nacional de borracha e castanha.  </p>",
    infoConflito: "<br /> <p> O território a ser conquistado despertou interesse do Brasil após a alta do látex.  O estado sofreu resistência uma vez que o território era pertencente à Bolívia, no dia 6 de agosto de 1902 Plácido de Castro e 33 homens invadem uma Intendência boliviana e aprisionam os soldados que ocupavam o local, mas  poucas semanas depois Castro e seus homens são surpreendidos e perdem o confronto contra cerca de 200 homens da força boliviana. Castro mais uma vez agora com 1000 homens em sua jornada reconquista algumas regiões do estado e batalha após batalha no ano seguinte o estado é conquistado e proclamado como território brasileiro. </p> ",
    dica: "<br /> <p> Foi o último estado a ser incluso no Brasil. </p>",
    correctAnswer: "AC"
}
]




const perguntasNordeste= [{
    conflito: "<h2>Invasão Holandesa</h2><br /><br /> <strong> Clique no estado em que ocorreu esse conflito. </strong>",
    infoEstado: "<br /> <p> Conhecidos como comedores de camarão, o estado tem sua economia respaldada na produção de frutas,  é o maior produtor de camarão do Brasil. Possui uma grande caatinga e praias conhecidas em todo o país. Terra dos cangaceiros. </p>",
    infoConflito: "<br /> <p> A Invasão Holandesa foi um conflito que começou a se alastrar desde a Bahia movido por uma vontade antiga da Holanda de se “apossar” do Brasil a partir de uma colonização que posteriormente permitiria um enriquecimento usufruindo das riquezas da Colônia de Portugal.  Os holandeses conseguiram dominar a capital colonial em apenas dois dias. Após isso, o Rei Filipe II enviou uma frota de 12 mil homens para Salvador reconquistando a Capital. Mesmo assim os holandeses não desistiram e finalmente após alguns anos invadiram um estado quase 10 anos depois da primeira tentativa à capital . Tal conflito desencadeou o massacre de Cunhaú e Uruaçu após perseguição religiosa e uma suposta “cobrança” de dívidas de alguns engenhos da região. </p> ",
    dica: "<br /> <p> Foi renomeada como a Nova Amsterdã </p>",
    correctAnswer: "RN"
}
]




const perguntasCentroOeste= [{
    conflito: "<h2>Rusga</h2><br /><br /> <strong> Clique no estado em que ocorreu esse conflito. </strong>",
    infoEstado: "<br /> <p> É um estado de povos diversos, uma mistura de índios, negros, espanhóis e portugueses que se miscigenaram nos primeiros anos do período colonial. É o único do Brasil a ter, sozinho, três dos principais biomas do país: Amazônia, Cerrado e Pantanal. </p>",
    infoConflito: "<br /> <p> Revolta pouco conhecida ocorrida durante o Período Regencial brasileiro, reflexo da então crescente rivalidade entre portugueses e brasileiros. O foco dos eventos foi a atual capital do estado, onde parte da elite local, desejosa de poder, se levantou contra a elite de ascendência portuguesa. Na noite de 30 de maio de 1834, a revolta eclodiu e iniciou a matança e o saque de dezenas de portugueses e pessoas ligadas a eles. Os líderes do movimento foram detidos e condenados e extinguiu-se a \"GUARDA MUNICIPAL\", que havia se envolvido diretamente no movimento. </p> ",
    dica: "<br /> <p> Estado é o maior criador de gado do país. </p>",
    correctAnswer: "MT"
}
]




const perguntasSudeste= [{
    conflito: "<h2>Revolta da vacina</h2><br /><br /> <strong> Clique no estado em que ocorreu esse conflito. </strong>",
    infoEstado: "<br /> <p> Grande parte da economia do estado se baseia na prestação de serviços, tendo uma parte significativa da indústria e pouca influência no setor de agropecuária. Sua capital é conhecida internacionalmente como \"cidade maravilhosa\" devido às belezas naturais. </p>",
    infoConflito: "<br /> <p> A capital do estado sofria com graves problemas urbanos e sociais: pobreza, desemprego, falta de saneamento e coleta de lixo, surtos de doenças como varíola, febre amarela e peste bubônica. Com a intenção de modernizar a cidade e controlar tais epidemias, o presidente Rodrigues Alves iniciou uma série de reformas urbanas e sanitárias que mudaram a geografia da cidade e o cotidiano de sua população. </p> <b /> <p>Nesse contexto, o congresso aprovou uma lei que instaurou a vacinação obrigatória da população contra a varíola. A medida autoritária e invasiva, sem a preocupação de esclarecimento da população a respeito da importância da medida, provocou uma revolta geral da população entre 10 e 16 de novembro de 1904. No dia 16 de novembro, foi decretado o estado de sítio e a suspensão da vacinação obrigatória. A revolta foi duramente reprimida, com centenas de participantes presos e deportados para o Acre. </p> ",
    dica: "<br /> <p> A capital do estado já foi a capital do Império (1822–1889) e da República (1889–1960). </p>",
    correctAnswer: "RJ"
}
]




const perguntasSul= [{
    conflito: "<h2>A Guerra de Farrapos</h2><br /><br/><strong> Clique no estado em que ocorreu esse conflito. </strong>",
    infoEstado: "<br /><p> Possui uma cultura própria derivada do amálgama da cultura ibérica e indígena que habitavam o pampa.</p>",
    infoConflito: "<br /> <p>A Guerra dos Farrapos foi um conflito de caráter republicano, contra o governo imperial do Brasil, e que resultou na declaração de independência da província como estado republicano. Ocorreu entre 1835 e 1845, inicialmente reivindicando a retirada de todos os portugueses que se mantinham nos mais altos cargos do Império e do Exército, mesmo depois da Independência. No entanto, a revolução adquiriu um caráter separatista.</p> ",
    dica: "<br /> <p> Um traje típico da região é a bombacha, uma calça abotoadas no tornozelo. O nome foi adotado do termo espanhol \"bombacho\", que significa \"calças largas\".</p>",
    correctAnswer: "RS"
}, {
    conflito: "<h2>O Contestado</h2><br /> <br /><strong> Clique no estado em que ocorreu esse conflito. </strong>",
    infoEstado: "<br /> <p> É o 20º estado brasileiro por área territorial e o 11.º por população. Sua cultura é derivada de imigrantes majoritariamente europeus (portugueses, italianos e alemães).</p>",
    infoConflito: "<br /> <p> A Guerra do Contestado ocorreu no período de 1912 a 1916. Dentre as principais causas estão a disputa territorial de uma área rica em erva-mate e madeira, o autoritarismo de coronéis locais e da guarda nacional e o impacto da construção de uma estrada de ferro que ligava o Rio Grande do sul a São Paulo. No fim da construção do trecho da estrada de ferro na região, como parte do acordo de concessão, a companhia responsável (Brazil Railway Company) recebeu do governo 15 km de cada lado da ferrovia e iniciou a desapropriação de 6.696 km² de terras ocupadas já há muito tempo por posseiros que viviam na região. Também, os trabalhadores, que vinham de todas as partes do Brasil, haviam sido dispensados com o fim do serviço e não tinham como retornar a sua terra de origem.</p> <br/> <p>A revolta também tinha um caráter messiânico e chegou a ser chamada de “um novo Canudos” pela imprensa da época. O movimento teve início com com um grupo muito pequeno de sertanejos que seguiam um curandeiro, o \"santo monge\" José Maria, com o intuito de formar uma comunidade autônoma, onde todos viveriam em comunhão de bens. No entanto, com o tempo ganhou força e até ex-combatentes da Revolução Federalista se juntaram ao movimento.</p> ",
    dica: "<br /> <p> Após a rendição do último líder dos insurgentes, houve a assinatura do acordo de limites entre os estados a qual pertencia a área contestada. O estado, cujo território atual compreende a maior parte da região do conflito, passou a fazer fronteira com a Argentina e Paraguai, enquanto que o outro estado deixou de fazer fronteira com um dos estados brasileiros.</p>",
    correctAnswer: "SC"
}, {
    conflito: "<h2>O Cerco da Lapa</h2><br /> <br/><strong> Clique no estado em que ocorreu esse conflito. </strong> ",
    infoEstado: "<br /> <p> Cultura derivada dos imigrantes majoritariamente europeus (portugueses, italianos, alemães e poloneses).</p>",
    infoConflito: " <br /> <p>O Cerco da Lapa foi um episódio militar (Exército Brasileiro, Guarda Nacional, Polícia Militar do estado e voluntários) que ocorreu durante a Revolução Federalista em 1894, quando a cidade de Lapa tornou-se arena de um sangrento confronto entre as tropas republicanas, os chamados pica-paus (legalistas), e os maragatos (federalistas), contrários ao sistema presidencialista de governo. Os legalistas resistiram bravamente ao cerco por 26 dias, mas sucumbiram pela falta de munição e comida. A lendária batalha deu ao Marechal Floriano Peixoto, chefe da República, tempo suficiente para reunir forças e deter as tropas federalistas.</p> ",
    dica: "<br /> <p> Esse estado também é conhecido como a terra dos pinheirais.</p>",
    correctAnswer: "PR"

}];

/*************************************** FIM DAS PERGUNTAS ***************************************/



var regSel=false,perguntaOK; //bool
var estadoReg, regiao, i,j;
var zIndReg, zIndEst;
var tentativa;
var pergunta=[];
var random_01;


function shuffle(array){
    var i,j, randomNum;
    var arrayOK;
    var array_shuffle=[];
    
    i=0;
    do{
	randomNum=Math.floor(Math.random()*array.length);
	arrayOK=true;
	for(j=0;j<array_shuffle.length;j++){
	    if(array_shuffle[j].correctAnswer===array[randomNum].correctAnswer)
		arrayOK=false;
	}

	if(arrayOK){
	    array_shuffle.push(Object.assign({},array[randomNum]));
	    i++;
	}
    }while(i<array.length);
    
//    console.log(array_shuffle);
    return array_shuffle;
}


// embaralha as questões
shuffle(perguntasNorte);
shuffle(perguntasNordeste);
shuffle(perguntasCentroOeste);
shuffle(perguntasSudeste);
shuffle(perguntasSul);


function getStyle(el,styleProp)
{
    var x = document.getElementById(el);

    if (window.getComputedStyle) {
        var y = document.defaultView.getComputedStyle(x,null).getPropertyValue(styleProp); 
    } else if (x.currentStyle) {
        var y = x.currentStyle[styleProp];
    }                     

    return Number(y);
}


function hideReg(id_reg) {
    
    pergunta=[];
    if (id_reg==='Norte'){
	for(i=0;i<perguntasNorte.length;i++){
	    pergunta.push(Object.assign({},perguntasNorte[i]));
	}
//	console.log(perguntasNorte);
//	console.log(pergunta);
	
    } else if (id_reg==='Nordeste'){
	for(i=0;i<perguntasNordeste.length;i++){
	    pergunta.push(Object.assign({},perguntasNordeste[i]));
	}
	
    } else if (id_reg==='CentroOeste'){
	for(i=0;i<perguntasCentroOeste.length;i++){
	    pergunta.push(Object.assign({},perguntasCentroOeste[i]));
	}
	
    } else if (id_reg==='Sudeste'){
	for(i=0;i<perguntasSudeste.length;i++){
	    pergunta.push(Object.assign({},perguntasSudeste[i]));
	}
	
     } else if (id_reg==='Sul'){
	for(i=0;i<perguntasSul.length;i++){
	    pergunta.push(Object.assign({},perguntasSul[i]));
	}
	
    }  
    
    
    zIndReg = getStyle(id_reg,"z-index");
    if(!regSel && zIndReg!==250){
	document.getElementById(id_reg).style.display="none";
	regSel=true;

	perguntaOK=0;
	do{
	    random_01=Math.floor(Math.random()*pergunta.length);

	    zIndEst= getStyle(pergunta[random_01].correctAnswer,"z-index");
	    if(zIndEst!==150){ 
		perguntaOK=1;
	    }
	} while(!perguntaOK);

	document.getElementById("tabPergunta").innerHTML=pergunta[random_01].conflito;
	document.getElementById("infoConf").innerHTML=pergunta[random_01].infoConflito;
	document.getElementById("infoGeo").innerHTML=pergunta[random_01].infoEstado;
	
	tentativa=0;

	// Eleve os estados que não foram virados apenas
	estadoReg=document.getElementsByClassName(id_reg);
	for(i=0;i<estadoReg.length;i++){
	    zIndEst = getStyle(estadoReg[i].id,"z-index");
	    if(zIndEst!==150){ 
		estadoReg[i].style.zIndex=zIndEst+200;
	    }
	    //console.log(estadoReg[i].id,"Antes:",zIndEst,"Depois:",getStyle(estadoReg[i].id,"z-index"))
	}
    } 

}

function showReg(){
    var numConquistas=0;
    
    regiao=document.getElementsByClassName("regiao-mapa");
    for(i=0;i<regiao.length;i++){
	if(regiao[i].style.display==="none"){

	    // Abaixe os estados que não foram virados apenas
	    estadoReg=document.getElementsByClassName(regiao[i].id);
	    for(j=0;j<estadoReg.length;j++){
		zIndEst=getStyle(estadoReg[j].id,"z-index");
		if(zIndEst!=150){ 
		    estadoReg[j].style.zIndex=zIndEst-200;
		} else {
		    numConquistas++;
		}
		//console.log(estadoReg[j].id,"Antes:",zIndEst,"Depois:",getStyle(estadoReg[j].id,"z-index"))
	    }
	    regiao[i].style.display="block";
	    if(numConquistas>=estadoReg.length/2){
		switchReg(regiao[i].id);
	    } 
	    break;
	}
    }

    document.getElementById("tabPergunta").innerHTML="<h2>Selecione uma região.</h2>";
    document.getElementById("infoConf").innerHTML="";
    document.getElementById("infoGeo").innerHTML="";
    $('.nav-pills a[href="#tabPergunta"]').tab('show');

}

function checaResp(id_state){

    console.log(id_state);
    alert(id_state);
    
    zIndEst = getStyle(id_state,"z-index");
    if(zIndEst!==150){
	tentativa++;
	if(pergunta[random_01].correctAnswer===id_state){
	    // se acertou
	    alert("Correto!");
	    switchState(id_state);
	    showReg();
	    regSel=false;
	} else if (tentativa===1){
	    // se errou pela primeira vez

	    document.getElementById("dica").innerHTML=pergunta[random_01].dica;
            $('.nav-pills a[href="#dica"]').toggleClass('disabled');
	    $('.nav-pills a[href="#dica"]').attr('data-toggle','pill');
	    $('.nav-pills a[href="#dica"]').tab('show');

    
	    alert("Estado incorreto! Tem mais uma tentativa.");
	    

	} else {
	    // se acertou ou errou após a dica
	    alert("Estado incorreto!");
	    showReg();
	    regSel=false;
	}
	
	if (tentativa>1){
	    $('.nav-pills a[href="#dica"]').toggleClass('disabled');
	    $('.nav-pills a[href="#dica"]').attr('data-toggle','');
	}
    }
}

function switchState(id_state) {
    document.getElementById(id_state).classList.add('switch');
    document.getElementById(id_state).style.zIndex=150;    
}

function switchReg(id_reg) {
    document.getElementById(id_reg).classList.add('switch');
    document.getElementById(id_reg).style.zIndex=250;    
}



//regioes.forEach(regiao => regiao.addEventListener('click', hideReg));



